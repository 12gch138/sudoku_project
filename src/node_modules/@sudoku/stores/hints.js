import { writable, get } from 'svelte/store';
import { settings } from '@sudoku/stores/settings';

function createHints() {
	const hints = writable(Infinity);

	// Keep track of current amount of hints for internal functions
	let currHints = 0;
	hints.subscribe(_hints => {
		currHints = _hints;
	});

	settings.subscribe((_settings) => {
		if (_settings.hintsLimited) {
			if (currHints > _settings.hints) {
				hints.set(_settings.hints);
			}
		} else {
			hints.set(Infinity);
		}
	});

	return {
		subscribe: hints.subscribe,

		useHint: () => {
			hints.update(h => h > 0 ? h - 1 : 0);
		},
	};
}

export const hints = createHints();