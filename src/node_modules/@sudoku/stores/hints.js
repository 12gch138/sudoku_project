import { settings } from '@sudoku/stores/settings';
import { writable } from 'svelte/store';

function createHints() {
	const hints = writable(Infinity);

	settings.subscribe(($settings) => {
		if ($settings.hintsLimited) {
			hints.update($hints => {
				if ($hints > $settings.hints) return $settings.hints;

				return $hints;
			})
		} else {
			hints.set(Infinity);
		}
	});

	return {
		subscribe: hints.subscribe,

		useHint() {
			hints.update($hints => $hints > 0 ? $hints - 1 : 0);
		},
	};
}

export const hints = createHints();