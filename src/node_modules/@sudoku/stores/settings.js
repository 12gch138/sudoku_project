import { writable } from 'svelte/store';
import { DEFAULT_SETTINGS } from '@sudoku/constants';

function createSettings() {
	const settings = writable((() => {
		if(!process.browser) return DEFAULT_SETTINGS;

		const storedSettings = localStorage.getItem('settings');

		if (storedSettings) {
			return JSON.parse(storedSettings);
		}

		return DEFAULT_SETTINGS;
	})());

	return {
		subscribe: settings.subscribe,

		set: (newSettings) => {
			settings.set(newSettings);
			localStorage.setItem('settings', JSON.stringify(newSettings));
		},
	};
}

export const settings = createSettings();