import { writable } from 'svelte/store';
import { DIFFICULTIES } from '@sudoku/constants';

function createDifficulty() {
	const difficulty = writable((() => {
		const storedDifficulty = localStorage.getItem('difficulty');

		if (DIFFICULTIES.hasOwnProperty(storedDifficulty)) {
			return storedDifficulty;
		}

		return Object.keys(DIFFICULTIES)[0];
	})());

	return {
		subscribe: difficulty.subscribe,

		set: (newDifficulty) => {
			if (DIFFICULTIES.hasOwnProperty(newDifficulty)) {
				difficulty.set(newDifficulty);
				localStorage.setItem('difficulty', newDifficulty);
			}
		},
	};
}

export const difficulty = createDifficulty();